"use strict";(self.webpackChunksuse_edge_docs=self.webpackChunksuse_edge_docs||[]).push([[1140],{3980:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>m,frontMatter:()=>r,metadata:()=>c,toc:()=>h});var s=t(5893),a=t(1151),l=t(4866),i=t(5162);const r={sidebar_position:5,title:"Remote host onboarding with Elemental"},o=void 0,c={id:"quickstart/elemental",title:"Remote host onboarding with Elemental",description:"What is Elemental?",source:"@site/docs/quickstart/elemental.mdx",sourceDirName:"quickstart",slug:"/quickstart/elemental",permalink:"/docs/quickstart/elemental",draft:!1,unlisted:!1,editUrl:"https://github.com/suse-edge/suse-edge.github.io/tree/main/docs/quickstart/elemental.mdx",tags:[],version:"current",lastUpdatedBy:"Andrew Gracey",lastUpdatedAt:1707758273,formattedLastUpdatedAt:"Feb 12, 2024",sidebarPosition:5,frontMatter:{sidebar_position:5,title:"Remote host onboarding with Elemental"},sidebar:"docs",previous:{title:"BMC automated deployments with Metal3",permalink:"/docs/quickstart/metal3"},next:{title:"Terminology",permalink:"/docs/concepts/terms"}},d={},h=[{value:"What is Elemental?",id:"what-is-elemental",level:2},{value:"Why use this method",id:"why-use-this-method",level:2},{value:"High Level Architecture",id:"high-level-architecture",level:2},{value:"Resources Needed",id:"resources-needed",level:2},{value:"How to Use Elemental",id:"how-to-use-elemental",level:2},{value:"Build Bootstrap Cluster",id:"build-bootstrap-cluster",level:3},{value:"Create Kubernetes Cluster",id:"create-kubernetes-cluster",level:4},{value:"Setup DNS",id:"setup-dns",level:4},{value:"Install Rancher",id:"install-rancher",level:4},{value:"Install Elemental",id:"install-elemental",level:4},{value:"(Optionally) Install the Elemental UI Extension",id:"optionally-install-the-elemental-ui-extension",level:4},{value:"Configure Elemental",id:"configure-elemental",level:4},{value:"Build installation media",id:"build-installation-media",level:3},{value:"Boot downstream nodes",id:"boot-downstream-nodes",level:3},{value:"Create downstream clusters",id:"create-downstream-clusters",level:3},{value:"Next steps",id:"next-steps",level:2},{value:"Planned changes",id:"planned-changes",level:2},{value:"Improved support for and integration with SLE Micro 6.x",id:"improved-support-for-and-integration-with-sle-micro-6x",level:4},{value:"Additional Resources",id:"additional-resources",level:2}];function u(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",mdxAdmonitionTitle:"mdxAdmonitionTitle",p:"p",pre:"pre",ul:"ul",...(0,a.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"what-is-elemental",children:"What is Elemental?"}),"\n",(0,s.jsx)(n.p,{children:"Elemental is a software stack that provides for remote control over the lifecycles of the Operating System, Kubernetes, and workload in a secure and declarative way."}),"\n",(0,s.jsx)(n.h2,{id:"why-use-this-method",children:"Why use this method"}),"\n",(0,s.jsx)(n.p,{children:"Elemental can be very useful for scenarios where the devices that you want to control are not on the same network as the upstream cluster or don't have a BMC onboard to allow more direct control."}),"\n",(0,s.jsx)(n.p,{children:"TODO: expand"}),"\n",(0,s.jsx)(n.h2,{id:"high-level-architecture",children:"High Level Architecture"}),"\n",(0,s.jsx)(n.p,{children:"TODO: Draw image"}),"\n",(0,s.jsx)(n.h2,{id:"resources-needed",children:"Resources Needed"}),"\n",(0,s.jsx)(n.p,{children:"At the very least, you need:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:['A host for the "upstream" cluster (the one hosting Rancher and Elemental) with:',"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Minimum 8GB RAM and 20GB disk space for development or testing"}),"\n",(0,s.jsxs)(n.li,{children:["For production use: See ",(0,s.jsx)(n.a,{href:"https://ranchermanager.docs.rancher.com/pages-for-subheaders/installation-requirements#hardware-requirements",children:"https://ranchermanager.docs.rancher.com/pages-for-subheaders/installation-requirements#hardware-requirements"})]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["A host to be controlled","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Could be physical device or Virtual Machine"}),"\n",(0,s.jsx)(n.li,{children:"Minimum 25GB disk"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["A resolvable hostname","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Or static ip address to use with a service like sslip.io"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["A host to build the installation media with","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"This would likely be your local computer for most people"}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://kubernetes.io/docs/reference/kubectl/kubectl/",children:"Kubectl"}),", ",(0,s.jsx)(n.a,{href:"https://podman.io",children:"Podman"}),", and ",(0,s.jsx)(n.a,{href:"https://helm.sh",children:"Helm"})," need to be installed"]}),"\n",(0,s.jsx)(n.li,{children:"TODO: edit this after writing the EIB doc"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["(If using physical hardware) A USB flash drive to boot from","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Existing will be overwritten as part of the process"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["In the writing of this guide, I will be using a Digital Ocean droplet to host the upstream cluster and an Intel NUC as the downstream device. For building the installation media, I will be using my desktop running ",(0,s.jsx)(n.a,{href:"https://get.opensuse.org/tumbleweed/",children:"openSUSE Tumbleweed"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"how-to-use-elemental",children:"How to Use Elemental"}),"\n",(0,s.jsx)(n.p,{children:"The basic steps to install and use Elemental are:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Build bootstrap cluster"}),"\n",(0,s.jsx)(n.li,{children:"Install Rancher"}),"\n",(0,s.jsx)(n.li,{children:"Install Elemental Operator and Rancher UI Extension"}),"\n",(0,s.jsx)(n.li,{children:"Build installer disk"}),"\n",(0,s.jsx)(n.li,{children:"Boot device with installer"}),"\n",(0,s.jsx)(n.li,{children:"Create downstream cluster"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"TODO: Record video and embed"}),"\n",(0,s.jsx)(n.h3,{id:"build-bootstrap-cluster",children:"Build Bootstrap Cluster"}),"\n",(0,s.jsx)(n.p,{children:"The first thing we need to do is create a cluster that can host Rancher and Elemental. This cluster needs to be routable from the network that the downstream nodes are connected to."}),"\n",(0,s.jsx)(n.p,{children:"TODO: make prose"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Create Kubernetes Cluster"}),"\n",(0,s.jsx)(n.li,{children:"Install Rancher"}),"\n",(0,s.jsx)(n.li,{children:"Install Elemental"}),"\n",(0,s.jsx)(n.li,{children:"(Optionally) Install Elemental UI Extension"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"create-kubernetes-cluster",children:"Create Kubernetes Cluster"}),"\n",(0,s.jsx)(n.p,{children:"If you are using a hyperscaler (such as Azure, AWS, or Google Cloud), it's likely easiest to set up a cluster using their built in tooling. For the sake of conciseness in this guide, we will not be detailing the process of each of these options."}),"\n",(0,s.jsxs)(n.p,{children:["If you are installing onto bare metal or another hosting service where you need to also provide the Kubernetes distribution itself, we recommend using ",(0,s.jsx)(n.a,{href:"https://docs.rke2.io/install/quickstart",children:"RKE2"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"TODO: Should I add more detail?"}),"\n",(0,s.jsx)(n.h4,{id:"setup-dns",children:"Setup DNS"}),"\n",(0,s.jsx)(n.p,{children:"Before continuing, you will need to setup access to your cluster. As with the setup of the cluster itself, how you configure DNS will be different depending on where it's being hosted."}),"\n",(0,s.jsxs)(n.admonition,{type:"tip",children:[(0,s.jsx)(n.mdxAdmonitionTitle,{}),(0,s.jsxs)(n.p,{children:["If you don't want to deal with setting up DNS records (for example this is just an ephemeral test server), you can use a service like ",(0,s.jsx)(n.a,{href:"https://sslip.io",children:"sslip.io"})," instead. With this service, you can resolve any ip address with ",(0,s.jsx)(n.code,{children:"<address>.sslip.io"}),"."]})]}),"\n",(0,s.jsx)(n.h4,{id:"install-rancher",children:"Install Rancher"}),"\n",(0,s.jsx)(n.p,{children:"To install Rancher, you need to get access to the kubeapi of the cluster you just created. This looks differently depending on what distribution of Kubernetes is being used."}),"\n",(0,s.jsxs)(n.p,{children:["For RKE2,the kubeconfig file will have been written to ",(0,s.jsx)(n.code,{children:"/etc/rancher/rke2/rke2.yaml"}),". Save this file to ",(0,s.jsx)(n.code,{children:"~/.kube/config"})," on your local system. You may need to edit the file to include the correct externally routable IP address or hostname."]}),"\n",(0,s.jsxs)(n.p,{children:["The simplest way to get Rancher installed is with these commands that can be found in the ",(0,s.jsx)(n.a,{href:"https://ranchermanager.docs.rancher.com/pages-for-subheaders/install-upgrade-on-a-kubernetes-cluster",children:"Rancher Documentation"}),":"]}),"\n",(0,s.jsx)(n.p,{children:'TODO: simplify these a bit\nTODO: Do I need to explicitly allow for "local" management in the helm install?'}),"\n",(0,s.jsxs)(l.Z,{groupId:"os",children:[(0,s.jsxs)(i.Z,{value:"linux",label:"Linux",default:!0,children:[(0,s.jsxs)(n.p,{children:["Install ",(0,s.jsx)(n.a,{href:"https://cert-manager.io",children:"cert-manager"}),":"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"helm repo add rancher-latest https://releases.rancher.com/server-charts/latest\nkubectl create namespace cattle-system\nkubectl apply -f https://github.com/cert-manager/cert-manager/releases/download/v1.13.3/cert-manager.crds.yaml\nhelm repo add jetstack https://charts.jetstack.io\nhelm repo update\nhelm install cert-manager jetstack/cert-manager \\\n  --namespace cert-manager \\\n  --create-namespace\n"})}),(0,s.jsx)(n.p,{children:"Then install Rancher itself:"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"helm install rancher rancher-latest/rancher \\\n  --namespace cattle-system \\\n  --set hostname=<DNS or sslip from above> \\\n  --set replicas=1 \\\n  --set bootstrapPassword=<PASSWORD_FOR_RANCHER_ADMIN>\n"})})]}),(0,s.jsxs)(i.Z,{value:"OSX",label:"Mac OS",children:[(0,s.jsxs)(n.p,{children:["Install ",(0,s.jsx)(n.a,{href:"https://cert-manager.io",children:"cert-manager"}),":"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"helm repo add rancher-latest https://releases.rancher.com/server-charts/latest\nkubectl create namespace cattle-system\nkubectl apply -f https://github.com/cert-manager/cert-manager/releases/download/v1.13.3/cert-manager.crds.yaml\nhelm repo add jetstack https://charts.jetstack.io\nhelm repo update\nhelm install cert-manager jetstack/cert-manager \\\n  --namespace cert-manager \\\n  --create-namespace\n"})}),(0,s.jsx)(n.p,{children:"Then install Rancher itself:"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"helm install rancher rancher-latest/rancher \\\n  --namespace cattle-system \\\n  --set hostname=<DNS or sslip from above> \\\n  --set replicas=1 \\\n  --set bootstrapPassword=<PASSWORD_FOR_RANCHER_ADMIN>\n"})})]}),(0,s.jsxs)(i.Z,{value:"windows",label:"Windows",children:[(0,s.jsxs)(n.p,{children:["Install ",(0,s.jsx)(n.a,{href:"https://cert-manager.io",children:"cert-manager"}),":"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-powershell",children:"helm repo add rancher-latest https://releases.rancher.com/server-charts/latest\nkubectl create namespace cattle-system\nkubectl apply -f https://github.com/cert-manager/cert-manager/releases/download/v1.13.3/cert-manager.crds.yaml\nhelm repo add jetstack https://charts.jetstack.io\nhelm repo update\nhelm install cert-manager jetstack/cert-manager `\n  --namespace cert-manager `\n  --create-namespace\n"})}),(0,s.jsx)(n.p,{children:"Then install Rancher itself:"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-powershell",children:"helm install rancher rancher-latest/rancher `\n  --namespace cattle-system `\n  --set hostname=<DNS or sslip from above> `\n  --set replicas=1 `\n  --set bootstrapPassword=<PASSWORD_FOR_RANCHER_ADMIN>\n"})})]})]}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsx)(n.p,{children:"If this is intended to be a production system, please use cert-manager to configure a real certificate (such as one from Let's Encrypt)."})}),"\n",(0,s.jsx)(n.p,{children:"Browse to the hostname you set up and log in to Rancher with the bootstrapPassword you used. There is a short setup process that you will be guided through."}),"\n",(0,s.jsx)(n.h4,{id:"install-elemental",children:"Install Elemental"}),"\n",(0,s.jsx)(n.p,{children:"With Rancher installed, you can now install Elemental itself!"}),"\n",(0,s.jsx)(n.p,{children:"The helm chart for Elemental is published as an OCI artifact so the installation is a little simpler than other charts. It can be installed from either the same shell you used to install Rancher or in the browser from within Rancher's shell."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"helm install --create-namespace -n cattle-elemental-system elemental-operator-crds oci://registry.suse.com/rancher/elemental-operator-crds-chart\nhelm install --create-namespace -n cattle-elemental-system elemental-operator oci://registry.suse.com/rancher/elemental-operator-chart\n"})}),"\n",(0,s.jsx)(n.h4,{id:"optionally-install-the-elemental-ui-extension",children:"(Optionally) Install the Elemental UI Extension"}),"\n",(0,s.jsx)(n.p,{children:'If you want to use the Elemental UI, you can go log in to your Rancher instance, click on the "hamburger menu" in the top left, then'}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Installing Elemental Extension1",src:t(1983).Z+"",width:"1353",height:"859"})}),"\n",(0,s.jsx)(n.p,{children:'From the "Available" tab on this page, you can then click "Install" on the Elemental card:'}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Installing Elemental Extension 2",src:t(1421).Z+"",width:"1353",height:"859"})}),"\n",(0,s.jsx)(n.p,{children:"Confirm that you want to install the extension:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Installing Elemental Extension 3",src:t(2651).Z+"",width:"1353",height:"859"})}),"\n",(0,s.jsx)(n.p,{children:"After this installs, you will be prompted to reload the page."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Installing Elemental Extension 4",src:t(1670).Z+"",width:"1353",height:"859"})}),"\n",(0,s.jsx)(n.p,{children:'Once you reload, you can access the Elemental Extension through the "OS Management" global app.'}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Accessing Elemental Extension ",src:t(6574).Z+"",width:"1353",height:"859"})}),"\n",(0,s.jsx)(n.p,{children:"TODO: annotate screenshots"}),"\n",(0,s.jsx)(n.p,{children:"TODO: retake screenshots with Rancher 2.8.2 and Elemental 1.4 once released"}),"\n",(0,s.jsx)(n.h4,{id:"configure-elemental",children:"Configure Elemental"}),"\n",(0,s.jsxs)(n.p,{children:["To allow machines to register to Elemental, we need to create a MachineRegistration object in the ",(0,s.jsx)(n.code,{children:"fleet-default"})," namespace."]}),"\n",(0,s.jsx)(n.p,{children:"A fairly basic version of this object is:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'apiVersion: elemental.cattle.io/v1beta1\nkind: MachineRegistration\nmetadata:\n  name: ele-quickstart-nodes\n  namespace: fleet-default\nspec:\n  machineName: "${System Information/Manufacturer}-${System Information/Serial Number}"\n  machineInventoryLabels:\n    manufacturer: "${System Information/Manufacturer}"\n    productName: "${System Information/Product Name}"\n'})}),"\n",(0,s.jsx)(n.p,{children:"We can create this object in a few ways:"}),"\n",(0,s.jsxs)(l.Z,{groupId:"ui",children:[(0,s.jsxs)(i.Z,{value:"yaml",label:"YAML",children:[(0,s.jsxs)(n.p,{children:["Create a file with the yaml from above called ",(0,s.jsx)(n.code,{children:"registration.yaml"})," the apply it with:"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"kubectl apply -f registration.yaml\n"})})]}),(0,s.jsxs)(i.Z,{value:"visual",label:"UI Extension",children:[(0,s.jsx)(n.p,{children:'From the OS Management Extension, click "Create Registration Endpoint":'}),(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Click Create Registration",src:t(4895).Z+"",width:"1353",height:"859"})}),(0,s.jsx)(n.p,{children:"Give this configuration a name"}),(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Add Name",src:t(3090).Z+"",width:"1353",height:"859"})}),(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsx)(n.p,{children:"You can ignore the Cloud Configuration field as the data here is overridden by the following steps with Edge Image Builder"})}),(0,s.jsx)(n.p,{children:'Next you can scroll down a bit and click "Add Label" for each label you want to be on the resource that gets created when a machine registers. This is useful for tracking which machine is which.'}),(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Add Labels",src:t(1516).Z+"",width:"1353",height:"859"})}),(0,s.jsx)(n.p,{children:'Lastly, click "Create" to save the configuration!'}),(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Click Create",src:t(4511).Z+"",width:"1353",height:"859"})})]})]}),"\n",(0,s.jsx)(n.p,{children:"Afterwards, find and note the endpoint that gets assigned:"}),"\n",(0,s.jsxs)(l.Z,{groupId:"ui",children:[(0,s.jsx)(i.Z,{value:"yaml",label:"YAML",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"kubectl get machineregistration ele-quickstart-nodes -n fleet-default -o jsonpath '{.status.registrationURL}'\n"})})}),(0,s.jsxs)(i.Z,{value:"visual",label:"UI Extension",children:[(0,s.jsx)(n.p,{children:'If you just created the configuration, you should see the Registration URL listed and can click "Copy" to copy the address:'}),(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Copy URL",src:t(7696).Z+"",width:"1353",height:"859"})}),(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsx)(n.p,{children:'If you clicked away from that screen you can click on "Registration Endpoints" in the left menu then click the name of the endpoint you just created.'})})]})]}),"\n",(0,s.jsx)(n.p,{children:"This URL will be used in the next step."}),"\n",(0,s.jsx)(n.h3,{id:"build-installation-media",children:"Build installation media"}),"\n",(0,s.jsxs)(n.p,{children:["While the current version of Elemental (at time of writing) does have a way to build it's own installation media, we need to do this with the Edge Image Builder instead so the resulting system is built with ",(0,s.jsx)(n.a,{href:"https://www.suse.com/products/micro/",children:"SLE Micro"})," as the base Operating System."]}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsxs)(n.p,{children:["For more details on the Edge Image Builder, you can check out the ",(0,s.jsx)(n.a,{href:"/docs/quickstart/eib",children:"Getting Started Guide for it"}),". Or, for a more full discussion on it's capabilities there is a [full page documenting it]."]})}),"\n",(0,s.jsx)(n.p,{children:"TODO: write the simplest EIB flow possible here"}),"\n",(0,s.jsx)(n.p,{children:"From a system with Podman, Docker, or Rancher desktop installed, run"}),"\n",(0,s.jsxs)(l.Z,{groupId:"os",children:[(0,s.jsxs)(i.Z,{value:"linux",label:"Linux",default:!0,children:[(0,s.jsx)(n.p,{children:"TODO: Add elemental rpms"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"mkdir -p eib_quickstart/base-images\nmkdir -p eib_quickstart/elemental\nmkdir -p eib_quickstart/rpms\n\ncurl <REGISTRATION URL FROM ABOVE> -o eib_quickstart/elemental/elemental.yaml\n\necho > /eib_quickstart/eib-config.yaml <<< HEREDOC\napiVersion: 1.0\nimage:\n    imageType: iso\n    baseImage: SLE-Micro.x86_64-5.5.0-Default-SelfInstall-GM.install.iso\n    outputImageName: elemental-image.iso\n\nHEREDOC\n\ndocker run --rm -it -v $PWD/eib_quickstart/:/eib registry.opensuse.org/home/atgracey/eib/container/containerfile/eib:latest /usr/bin/eib -config-file eib-config.yaml -config-dir /eib -build-dir /eib/_build\n\nTODO: update image to released image on release\n\n"})}),(0,s.jsxs)(n.admonition,{type:"note",children:[(0,s.jsx)(n.mdxAdmonitionTitle,{}),(0,s.jsx)(n.p,{children:"Podman can be used in place of docker"})]})]}),(0,s.jsx)(i.Z,{value:"OSX",label:"Mac OS",children:(0,s.jsx)(n.p,{children:"TODO: any difference?"})}),(0,s.jsx)(i.Z,{value:"windows",label:"Windows",children:(0,s.jsx)(n.p,{children:"TODO: ???"})})]}),"\n",(0,s.jsx)(n.p,{children:"If you are booting a physical device, we need to burn the image to a USB flash drive. This can be done with:"}),"\n",(0,s.jsxs)(l.Z,{groupId:"os",children:[(0,s.jsxs)(i.Z,{value:"linux",label:"Linux",default:!0,children:[(0,s.jsx)(n.p,{children:"TODO: how to find sdX"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"sudo dd if=/path/to/output.iso of=/dev/sdX\n"})})]}),(0,s.jsxs)(i.Z,{value:"OSX",label:"Mac OS",children:[(0,s.jsx)(n.p,{children:"TODO: any difference?"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"sudo dd if=/path/to/output.iso of=/dev/sdX\n"})})]}),(0,s.jsx)(i.Z,{value:"windows",label:"Windows",children:(0,s.jsx)(n.p,{children:"TODO: ???"})})]}),"\n",(0,s.jsx)(n.h3,{id:"boot-downstream-nodes",children:"Boot downstream nodes"}),"\n",(0,s.jsx)(n.p,{children:"Now that we have the installation media created, we can boot our downstream nodes with it."}),"\n",(0,s.jsx)(n.p,{children:"For each of the systems that you want to control with Elemental, add the installation media and boot the device. After installation, it will reboot and register itself."}),"\n",(0,s.jsx)(n.p,{children:'If you are using the UI Extension, you should see your node appear in the "Inventory of Machines".'}),"\n",(0,s.jsx)(n.h3,{id:"create-downstream-clusters",children:"Create downstream clusters"}),"\n",(0,s.jsx)(n.p,{children:"Now that Elemental can see and control our downstream machines, we can create a cluster from those machine."}),"\n",(0,s.jsxs)(l.Z,{groupId:"ui",children:[(0,s.jsxs)(i.Z,{value:"yaml",label:"YAML",children:[(0,s.jsx)(n.p,{children:"There are two objects that we need to create when provisioning a new cluster using Elemental."}),(0,s.jsx)(n.p,{children:"The first is the MachineInventorySelectorTemplate. This object allows us to specify a mapping between Clusters and the machines in inventory."}),(0,s.jsxs)(n.p,{children:["Create a file called ",(0,s.jsx)(n.code,{children:"selector.yaml"})," with the contents:"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"apiVersion: elemental.cattle.io/v1beta1\nkind: MachineInventorySelectorTemplate\nmetadata:\nname: location-123-selector\nnamespace: fleet-default\nspec:\ntemplate:\n  spec:\n    selector:\n      matchLabel:\n        locationID: 123\n"})}),(0,s.jsx)(n.p,{children:"The we can create it with"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"kubectl create -f selector.yaml \n"})}),(0,s.jsxs)(n.p,{children:["This will match any machine in the inventory with the label ",(0,s.jsx)(n.code,{children:"locationID: 123"})," so we need to add this label to the machines that should be matched. We can do this with:"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"kubectl label MachineInventory -n fleet-default <name of MachineInventory object> locationID=123\n"})}),(0,s.jsx)(n.p,{children:"Next, we create the cluster itself. There are a lot of options here but a simple single-node K3s Cluster looks like:"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"apiVersion: provisioning.cattle.io/v1\nkind: Cluster\nmetadata:\nname: location-123\nnamespace: fleet-default\nspec:\nkubernetesVersion: v1.26.11+k3s2\nrkeConfig:\n  machinePools:\n    - name: pool1\n      etcdRole: true\n      controlPlaneRole: true\n      workerRole: true\n      machineConfigRef:\n        kind: MachineInventorySelectorTemplate\n        name: location-123-selector\n        apiVersion: elemental.cattle.io/v1beta1\n        quantity: 1\n"})}),(0,s.jsxs)(n.p,{children:["To provision this cluster, we can create a file with these contents called ",(0,s.jsx)(n.code,{children:"cluster.yaml"})," and run"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"kubectl create -f cluster.yaml\n"})})]}),(0,s.jsxs)(i.Z,{value:"visual",label:"UI Extension",children:[(0,s.jsx)(n.p,{children:"The UI extension allows for a few shortcuts to be taken. (But is likely to much manual work when managing a large number of locations)"}),(0,s.jsx)(n.p,{children:'As before, open the left "hamburger menu" and select "OS Management".'}),(0,s.jsx)(n.p,{children:"This will bring you back to the main screen for managing you Elemental systems."}),(0,s.jsx)(n.p,{children:'On the left sidebar, click "Inventory of Machines".'}),(0,s.jsx)(n.p,{children:"This, unsurprisingly, opens the inventory of machines that have registered."}),(0,s.jsx)(n.p,{children:'To create a cluster from these machines select the system(s) you want to you, click the "Actions" dropdown, then "Create Elemental Cluster".'}),(0,s.jsx)(n.p,{children:"This will open up the Cluster Creation dialog while also creating a MachineSelectorTemplate to use in the background."}),(0,s.jsx)(n.p,{children:"On this screen, you can configure the cluster you want to be built. For this quickstart, I will select K3s v1.26.11+k3s2 and leave the rest of the options alone."}),(0,s.jsx)(n.p,{children:"TODO: Screenshot"}),(0,s.jsx)(n.p,{children:"TODO: update version of k3s once new Rancher version is stable"}),(0,s.jsxs)(n.admonition,{type:"tip",children:[(0,s.jsx)(n.mdxAdmonitionTitle,{}),(0,s.jsx)(n.p,{children:"You may need to scroll down to see more options"})]}),(0,s.jsx)(n.p,{children:"TODO: Screenshots"})]})]}),"\n",(0,s.jsx)(n.p,{children:"After creating these objects, you should see a new kubernetes cluster spin up using the new node you just installed with."}),"\n",(0,s.jsxs)(n.admonition,{type:"tip",children:[(0,s.jsx)(n.p,{children:"To allow for easier grouping of systems, you could add a startup script that finds something in the environment that is known to be unique to that location."}),(0,s.jsx)(n.p,{children:"For example, if you know that each location will have a unique subnet, you would write a script that finds the network prefix and adds a label to the corresponding MachineInventory."}),(0,s.jsx)(n.p,{children:"This would typically be custom to your system's design but could look like:"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'INET=`ip addr show dev eth0 | grep "inet\\ "`\n\nelemental-register --label "network=$INET" --label "network=$INET" /oem/registration\n'})})]}),"\n",(0,s.jsx)(n.h2,{id:"next-steps",children:"Next steps"}),"\n",(0,s.jsx)(n.p,{children:"TODO: prose"}),"\n",(0,s.jsx)(n.p,{children:"Some recommended next steps after using this guide are:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"End to end automation with Fleet (TODO: Create page and link)"}),"\n",(0,s.jsx)(n.li,{children:"Additional network configuration options (TODO: Link to right section in EIB)"}),"\n",(0,s.jsx)(n.li,{children:"TODO: ???"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"planned-changes",children:"Planned changes"}),"\n",(0,s.jsx)(n.p,{children:"There are a few changes to this that are currently planned (at time of writing):"}),"\n",(0,s.jsx)(n.h4,{id:"improved-support-for-and-integration-with-sle-micro-6x",children:"Improved support for and integration with SLE Micro 6.x"}),"\n",(0,s.jsx)(n.p,{children:"TODO: write more about this"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Image building done in the Elemental Operator"}),"\n",(0,s.jsx)(n.li,{children:"Both A/B and RPM based transactional updates"}),"\n",(0,s.jsx)(n.li,{children:"UI improvements for non-teal images"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"These improvements are expected to be included in the SUSE Edge 3.1"}),"\n",(0,s.jsx)(n.h2,{id:"additional-resources",children:"Additional Resources"}),"\n",(0,s.jsx)(n.p,{children:"TODO: What additional resources should we link?"})]})}function m(e={}){const{wrapper:n}={...(0,a.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}},5162:(e,n,t)=>{t.d(n,{Z:()=>i});t(7294);var s=t(6010);const a={tabItem:"tabItem_Ymn6"};var l=t(5893);function i(e){let{children:n,hidden:t,className:i}=e;return(0,l.jsx)("div",{role:"tabpanel",className:(0,s.Z)(a.tabItem,i),hidden:t,children:n})}},4866:(e,n,t)=>{t.d(n,{Z:()=>v});var s=t(7294),a=t(6010),l=t(2466),i=t(6550),r=t(469),o=t(1980),c=t(7392),d=t(12);function h(e){return s.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,s.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function u(e){const{values:n,children:t}=e;return(0,s.useMemo)((()=>{const e=n??function(e){return h(e).map((e=>{let{props:{value:n,label:t,attributes:s,default:a}}=e;return{value:n,label:t,attributes:s,default:a}}))}(t);return function(e){const n=(0,c.l)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function m(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function p(e){let{queryString:n=!1,groupId:t}=e;const a=(0,i.k6)(),l=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:n,groupId:t});return[(0,o._X)(l),(0,s.useCallback)((e=>{if(!l)return;const n=new URLSearchParams(a.location.search);n.set(l,e),a.replace({...a.location,search:n.toString()})}),[l,a])]}function g(e){const{defaultValue:n,queryString:t=!1,groupId:a}=e,l=u(e),[i,o]=(0,s.useState)((()=>function(e){let{defaultValue:n,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!m({value:n,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const s=t.find((e=>e.default))??t[0];if(!s)throw new Error("Unexpected error: 0 tabValues");return s.value}({defaultValue:n,tabValues:l}))),[c,h]=p({queryString:t,groupId:a}),[g,x]=function(e){let{groupId:n}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(n),[a,l]=(0,d.Nk)(t);return[a,(0,s.useCallback)((e=>{t&&l.set(e)}),[t,l])]}({groupId:a}),j=(()=>{const e=c??g;return m({value:e,tabValues:l})?e:null})();(0,r.Z)((()=>{j&&o(j)}),[j]);return{selectedValue:i,selectValue:(0,s.useCallback)((e=>{if(!m({value:e,tabValues:l}))throw new Error(`Can't select invalid tab value=${e}`);o(e),h(e),x(e)}),[h,x,l]),tabValues:l}}var x=t(2389);const j={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var f=t(5893);function b(e){let{className:n,block:t,selectedValue:s,selectValue:i,tabValues:r}=e;const o=[],{blockElementScrollPositionUntilNextRender:c}=(0,l.o5)(),d=e=>{const n=e.currentTarget,t=o.indexOf(n),a=r[t].value;a!==s&&(c(n),i(a))},h=e=>{let n=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const t=o.indexOf(e.currentTarget)+1;n=o[t]??o[0];break}case"ArrowLeft":{const t=o.indexOf(e.currentTarget)-1;n=o[t]??o[o.length-1];break}}n?.focus()};return(0,f.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.Z)("tabs",{"tabs--block":t},n),children:r.map((e=>{let{value:n,label:t,attributes:l}=e;return(0,f.jsx)("li",{role:"tab",tabIndex:s===n?0:-1,"aria-selected":s===n,ref:e=>o.push(e),onKeyDown:h,onClick:d,...l,className:(0,a.Z)("tabs__item",j.tabItem,l?.className,{"tabs__item--active":s===n}),children:t??n},n)}))})}function w(e){let{lazy:n,children:t,selectedValue:a}=e;const l=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=l.find((e=>e.props.value===a));return e?(0,s.cloneElement)(e,{className:"margin-top--md"}):null}return(0,f.jsx)("div",{className:"margin-top--md",children:l.map(((e,n)=>(0,s.cloneElement)(e,{key:n,hidden:e.props.value!==a})))})}function y(e){const n=g(e);return(0,f.jsxs)("div",{className:(0,a.Z)("tabs-container",j.tabList),children:[(0,f.jsx)(b,{...e,...n}),(0,f.jsx)(w,{...e,...n})]})}function v(e){const n=(0,x.Z)();return(0,f.jsx)(y,{...e,children:h(e.children)},String(n))}},6574:(e,n,t)=>{t.d(n,{Z:()=>s});const s=t.p+"assets/images/accessing-elemental-extension-6143462ce1eea605e25f5454a4d6ba66.png"},4895:(e,n,t)=>{t.d(n,{Z:()=>s});const s=t.p+"assets/images/click-create-registration-493af653d338126b226b657d305e3c9d.png"},4511:(e,n,t)=>{t.d(n,{Z:()=>s});const s=t.p+"assets/images/create-registration-create-1fe0913b53ec05b834fcd1ec7c59aa32.png"},1516:(e,n,t)=>{t.d(n,{Z:()=>s});const s=t.p+"assets/images/create-registration-labels-9ceb696673795427db6870ce08e60144.png"},3090:(e,n,t)=>{t.d(n,{Z:()=>s});const s=t.p+"assets/images/create-registration-name-f3df57c6a8b47d6240f0ce7fcab617ce.png"},7696:(e,n,t)=>{t.d(n,{Z:()=>s});const s=t.p+"assets/images/get-registration-url-8ce84a346b022e286820506053502f2b.png"},1983:(e,n,t)=>{t.d(n,{Z:()=>s});const s=t.p+"assets/images/installing-elemental-extension-1-6ace6ea9ec2a100f0f7e72441f360053.png"},1421:(e,n,t)=>{t.d(n,{Z:()=>s});const s=t.p+"assets/images/installing-elemental-extension-2-9f3190322abf8d0b6da5f7843a384a97.png"},2651:(e,n,t)=>{t.d(n,{Z:()=>s});const s=t.p+"assets/images/installing-elemental-extension-3-d98924b7f37a848cb405ef9c7d9f37d3.png"},1670:(e,n,t)=>{t.d(n,{Z:()=>s});const s=t.p+"assets/images/installing-elemental-extension-4-a67a5bb25e84c68c9381a16dfa14a578.png"},1151:(e,n,t)=>{t.d(n,{Z:()=>r,a:()=>i});var s=t(7294);const a={},l=s.createContext(a);function i(e){const n=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);